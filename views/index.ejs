<!DOCTYPE html>
<html lang="ar" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo-List</title>
    <link rel="stylesheet" href="./css/allTodoListsstyle.css" />
  </head>
  <body>
    <div class="app-container">
      <header>
        <h1>Todos List</h1>
      </header>

      <form action="/add-todo" method="POST" class="add-form">
        <input type="text" name="title" placeholder="next plan   " required />
        <button type="submit">Add</button>
      </form>

      <ul class="todo-list">
        <% todos.forEach(todo => { %>
        <li class="<%= todo.completed ? 'is-completed' : '' %>">
          <div class="todo-content">
            <span class="text"><%= todo.title %></span>
          </div>

          <div class="todo-actions">
            <a href="/toggle-todo/<%= todo.id %>" title="ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©">
              <%= todo.completed ? 'â†©ï¸' : 'âœ…' %>
            </a>
            <button
              onclick="editTodo('<%= todo.id %>', '<%= todo.title %>')"
              class="btn-edit"
              title="ØªØ¹Ø¯ÙŠÙ„"
            >
              âœï¸
            </button>
            <a
              href="/delete-todo/<%= todo.id %>"
              class="btn-delete"
              title="Ø­Ø°Ù"
              onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ')"
              >ğŸ—‘ï¸</a
            >
          </div>
        </li>
        <% }) %>
      </ul>

      <% if (todos.length === 0) { %>
      <div class="empty-state">
        <p>don't have any todos yet</p>
      </div>
      <% } %>
    </div>

    <script>
      function editTodo(id, oldTitle) {
        const newTitle = prompt("ØªØ¹Ø¯ÙŠÙ„ Ù†Øµ Ø§Ù„Ù…Ù‡Ù…Ø©:", oldTitle);
        if (newTitle && newTitle.trim() !== "" && newTitle !== oldTitle) {
          const form = document.createElement("form");
          form.method = "POST";
          form.action = `/edit-todo/${id}`;

          const input = document.createElement("input");
          input.type = "hidden";
          input.name = "title";
          input.value = newTitle;

          form.appendChild(input);
          document.body.appendChild(form);
          form.submit();
        }
      }
    </script>
  </body>
</html>
